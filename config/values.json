{
  "ApiVersion": "machinelearning.seldon.io/v1alpha2",
  "Chart": {
    "Name": "example-model",
    "Version": "0.1.0",
    "Description": "An example Seldon model with advanced features"
  },
  "DeploymentName": "fs33kafka",
  "Namespace": "app-fdd",
  "Metadata": {
    "Labels": {
      "components": "seldon-core",
      "entity": "online-model"
    },
    "Annotations": {}
  },
  "Predictors": [
    {
      "Name": "loan-approval",
      "Replicas": 1,
      "ComponentSpec": {
        "ServiceAccountName": "default-editor",
        "TerminationGracePeriodSeconds": 0,
        "Containers": [
          {
            "Name": "fs33kafka",
            "Env": [
              { "Name": "GUNICORN_WORKERS", "Value": "2" },
              { "Name": "GUNICORN_THREADS", "Value": "2" }
            ],
            "Liveness": {
              "Path": "/health/ping",
              "Port": "http",
              "Scheme": "HTTP",
              "InitialDelaySeconds": 80,
              "PeriodSeconds": 5,
              "FailureThreshold": 200,
              "SuccessThreshold": 1
            },
            "Readiness": {
              "Path": "/health/ping",
              "Port": "http",
              "Scheme": "HTTP",
              "InitialDelaySeconds": 80,
              "PeriodSeconds": 5,
              "FailureThreshold": 200,
              "SuccessThreshold": 1
            },
            "Resources": {
              "Limits": {
                "cpu": "2.0",
                "memory": "4.0Gi"
              },
              "Requests": {
                "cpu": "2.0",
                "memory": "4.0Gi"
              }
            }
          },
          {
            "Name": "input-transformer",
            "Image": "harbor-dognauts.neoflex.ru/dognauts/feast-rest-enricher:v0.1.0",
            "Env": [
              { "Name": "GUNICORN_WORKERS", "Value": "2" },
              { "Name": "GUNICORN_THREADS", "Value": "2" },
              { "Name": "modelURI", "Value": "s3://app-fdd/1/2f50d812d476495d90d4c566a2f99d4d/artifacts/model" },
              { "Name": "MLFLOW_S3_ENDPOINT_URL", "Value": "https://s3-mlops.neoflex.ru" },
              { "Name": "AWS_ACCESS_KEY_ID", "Value": "8A8TWIG7I0PUKUD5HU7J" },
              { "Name": "AWS_SECRET_ACCESS_KEY", "Value": "Ns4Oi92O5DAGZ015rp2zWe4BQw8rt1pFBDkJGrMJ" },
              { "Name": "FEAST_FEATURE_SERVER_URL", "Value": "http://feast-feature-server.app-fdd:80/" }
            ]
          }
        ]
      },
      "SvcOrchSpec": {
        "Env": [
          { "Name": "LOGGER_KAFKA_BROKER", "Value": "kafka-kafka-0.kafka-kafka-brokers.dognauts-kafka.svc:9093" },
          { "Name": "LOGGER_KAFKA_TOPIC", "Value": "model-drift-demo" },
          { "Name": "KAFKA_SECURITY_PROTOCOL", "Value": "sasl_ssl" },
          {
            "Name": "KAFKA_SSL_CA_CERT",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "cluster-ca.cert" }
            }
          },
          {
            "Name": "KAFKA_SSL_CLIENT_CERT",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "clients-ca.cert" }
            }
          },
          {
            "Name": "KAFKA_SSL_CLIENT_KEY",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "clients-ca.key" }
            }
          },
          {
            "Name": "KAFKA_SSL_CLIENT_KEY_PASS",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "clients-ca.pass" }
            }
          },
          {
            "Name": "KAFKA_SASL_PASSWORD",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "sasl.pass" }
            }
          },
          {
            "Name": "KAFKA_SASL_USERNAME",
            "ValueFrom": {
              "SecretKeyRef": { "Name": "kafka-cluster-creds", "Key": "sasl-user" }
            }
          },
          { "Name": "KAFKA_SASL_MECHANISM", "Value": "SCRAM-SHA-512" }
        ]
      },
      "Graph": {
        "Name": "input-transformer",
        "Type": "TRANSFORMER",
        "Endpoint": {
          "Type": "REST"
        },
        "Children": [
          {
            "Name": "fs33kafka",
            "Implementation": "MLFLOW_SERVER",
            "ModelUri": "s3://app-fdd/1/2f50d812d476495d90d4c566a2f99d4d/artifacts/model",
            "EnvSecretRefName": "seldon-secret",
            "Logger": {
              "Mode": "response"
            },
            "Parameters": [
              {
                "Name": "xtype",
                "Type": "STRING",
                "Value": "DataFrame"
              }
            ],
            "Children": []
          }
        ]
      }
    }
  ]
}
